{"version":3,"sources":["main.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"main.js","sourcesContent":["\"use strict\";\nconsole.log(\">> Ready :)\");\n\nlet series = [];\nconst favSeries = [];\nconst inputText = document.querySelector(\".js-input\");\nconst buttonSearch = document.querySelector(\".js-button\");\n//const mainList = document.querySelector(\".js-list\");\n\nconst defImage = \"https://via.placeholder.com/210x295/ffffff/666666/?text=TV\";\n\n// traer datos del servidor/API\n\nconst getDataFromServer = () => {\n  return fetch(`http://api.tvmaze.com/search/shows?q=${inputText.value}`)\n    .then(response => response.json())\n    .then(data => {\n      console.log(\"Fetch data from server and return it as JSON >>> Return\", data);\n      data = formatData(data);\n      saveDataInSeries(data);\n      paintSeries();\n      listenSeries();\n      getSeriesFromLS();\n      setSeriesIntoLS(); //despues de guardar\n    });\n};\n\n// creamos array de las peliculas buscadas, con los datos necesarios\nconst formatData = function(data) {\n  const searchResult = [];\n  //for (const palette of data.palettes) {\n  // for (let i = 0; i < data.length; i = i + 1) {\n  //   searchResult.push({\n  //     name: data[i].show.name,\n  //     image: data[i].show.image.medium\n  // }\n  for (const serieItem of data) {\n    searchResult.push({\n      name: serieItem.show.name,\n      image: defaultImage(serieItem)\n    });\n  }\n\n  console.log(\"Format JSON data and return it as array >>> Return\", searchResult);\n  return searchResult;\n};\n\n// poner imagen para las que no tenga imagen\nconst defaultImage = function(serieItem) {\n  if (serieItem.show.image === null) {\n    return \"https://via.placeholder.com/210x295/ffffff/666666/?text=TV\";\n  } else {\n    return serieItem.show.image.medium;\n  }\n};\n\n//Guarda los datos en el array\nconst saveDataInSeries = data => {\n  // guardar datos en array creada al inicio\n  series = data;\n  console.log(\"Save data in series array >> series\", series);\n};\n\nconst paintSeries = () => {\n  // cojo elemento contenedor del DOM\n  const mainList = document.querySelector(\".js-list\");\n  // declaramos string vacío para pasarlo por el innerHTML\n  let htmlCode = \"\";\n  for (let serieIndex = 0; serieIndex < series.length; serieIndex = serieIndex + 1) {\n    htmlCode += `<div class=\"series__item \n    ${getFavClassName(serieIndex)}\n    js-serie\" data-index=\"${serieIndex}\">`;\n    htmlCode += `<img  class=\"series__image\" src=\"${series[serieIndex].image}\" alt=\"\">`;\n    htmlCode += `<p class=\"series__name\n    ${getFavClassName(serieIndex)}\">${series[serieIndex].name}</p>`;\n    htmlCode += \"</div>\";\n  }\n  mainList.innerHTML = htmlCode;\n  console.log(\"Paint series form `series` array into DOM >>> series:\", series, \"Favourites:\", favSeries);\n};\n\nconst getFavClassName = serieIndex => {\n  if (isFavSerie(serieIndex)) {\n    return \"serie__item--favourite\";\n  } else {\n    return \"\";\n  }\n};\n\n// Esuchar si se ha hecho click (fav) y coger esa acción\nconst listenSeries = () => {\n  console.log(\"Listen click on new serie DOM elements\");\n  const serieContainer = document.querySelectorAll(\".js-serie\");\n  for (const serieContainerIndex of serieContainer) {\n    serieContainerIndex.addEventListener(\"click\", handleClick);\n  }\n};\n\n// en el handle vemos si esta o no clickada como fav\nconst handleClick = ev => {\n  // cogemos la serie seleccionada/clickada\n  const serieIndex = getClickedSerieIndex(ev);\n  if (isFavSerie(serieIndex)) {\n    removeFav(serieIndex);\n  } else {\n    addFav(serieIndex);\n  }\n\n  paintSeries();\n  listenSeries();\n  // Actualizar LS con los favoritos\n  getSeriesFromLS();\n  setSeriesIntoLS();\n};\n\nconst getClickedSerieIndex = ev => {\n  // currentTarget sobre el que escucho el ev\n  const currentTarget = ev.currentTarget;\n  // index es una propiedad añadida con data-*, la convertimos a nº\n  const clickedSerieIndex = parseInt(currentTarget.dataset.index);\n  console.log(\"Get clicked palette from event and return the clicked palette index >>> Clicked palette:\", clickedSerieIndex);\n  return clickedSerieIndex;\n};\n\nconst isFavSerie = serieIndex => {\n  const foundIndex = favSeries.indexOf(series[serieIndex]);\n  // acción + operación matemática =0 --> boolean\n  if (foundIndex >= 0) {\n    console.log(`Check if serieIndex ${serieIndex} it is favourite >>>`, true);\n    return true;\n  } else {\n    console.log(`Check if serieIndex ${serieIndex} it is not favourite >>>`, false);\n    return false;\n  }\n};\n\nconst addFav = serieIndex => {\n  // Tenemos que pasarle el objeto entero para llamarlo de LS\n  favSeries.push(series[serieIndex]);\n  //favSeries.push(serieIndex);\n  console.log(\"Add serieIndex to `favSeries` array >>> Favourites:\", favSeries);\n  paintFavSeries();\n  getSeriesFromLS();\n  setSeriesIntoLS();\n  paintSeries();\n  listenSeries();\n};\n\nconst removeFav = serieIndex => {\n  const favIndex = favSeries.indexOf(series[serieIndex]);\n  favSeries.splice(favIndex, 1);\n  console.log(\"Remove paletteIndex from `favSeries` array >>> Favourites:\", favSeries);\n  paintFavSeries();\n  listenSeries();\n};\n\n// Escribir (set) y recuperar (get) datos del Local Storage\nconst getSeriesFromLS = () => {\n  return JSON.parse(localStorage.getItem(\"favSeries\"));\n};\n\nconst setSeriesIntoLS = () => {\n  localStorage.setItem(\"favSeries\", JSON.stringify(favSeries));\n};\n\nconst paintFavSeries = () => {\n  //debugger;\n  const favUl = document.querySelector(\".js-listFav\");\n  let htmlCodeFav = \"\";\n  for (let favIndexx = 0; favIndexx < favSeries.length; favIndexx = favIndexx + 1) {\n    htmlCodeFav += `<li class=\"fav__item js-fav\">`;\n    htmlCodeFav += `<img class=\"fav__image\" src=\"${favSeries[favIndexx].image}\">`;\n    htmlCodeFav += `<p class=\"fav__name\">${favSeries[favIndexx].name}</p></li>`;\n  }\n  favUl.innerHTML = htmlCodeFav;\n};\n\nbuttonSearch.addEventListener(\"click\", getDataFromServer);\n"]}