"use strict";let series=[],favSeries=[];const inputText=document.querySelector(".js-input"),buttonSearch=document.querySelector(".js-button"),defImage="https://via.placeholder.com/210x295/ffffff/666666/?text=TV",getSeriesFromLS=()=>{const e=JSON.parse(localStorage.getItem("favSeries"));!0==!!e&&(favSeries=e)},setSeriesIntoLS=()=>{localStorage.setItem("favSeries",JSON.stringify(favSeries))},startSearch=()=>{null===getSeriesFromLS()?buttonSearch.addEventListener("click",getDataFromServer):(paintFavSeries(),buttonSearch.addEventListener("click",getDataFromServer))},getDataFromServer=()=>fetch(`http://api.tvmaze.com/search/shows?q=${inputText.value}`).then(e=>e.json()).then(e=>{e=formatData(e),saveDataInSeries(e),paintSeries(),listenSeries(),getSeriesFromLS(),setSeriesIntoLS()}),formatData=function(e){const t=[];for(const a of e)t.push({name:a.show.name,image:defaultImage(a)});return console.log("Format JSON data and return it as array >>> Return",t),t},defaultImage=function(e){return null===e.show.image?"https://via.placeholder.com/210x295/ffffff/666666/?text=TV":e.show.image.medium},saveDataInSeries=e=>{series=e,console.log("Save data in series array >> series",series)},paintSeries=()=>{const e=document.querySelector(".js-list");let t="";for(let e=0;e<series.length;e+=1)t+=`<div class="series__item \n    ${getFavClassName(e)}\n    js-serie" data-index="${e}">`,t+=`<img  class="series__image" src="${series[e].image}" alt="">`,t+=`<p class="series__name\n    ${getFavClassName(e)}">${series[e].name}</p>`,t+="</div>";e.innerHTML=t},getFavClassName=e=>isFavSerie(e)?"serie__item--favourite":"",handleClick=e=>{const t=getClickedSerieIndex(e);isFavSerie(t)?removeFav(t):addFav(t),paintFavSeries(),setSeriesIntoLS(),getSeriesFromLS(),paintFavSeries(),paintSeries(),getSeriesFromLS(),setSeriesIntoLS()},listenSeries=()=>{const e=document.querySelectorAll(".js-serie");for(const t of e)t.addEventListener("click",handleClick)},getClickedSerieIndex=e=>{const t=e.currentTarget;return parseInt(t.dataset.index)},isFavSerie=e=>{return favSeries.some(t=>t.name===series[e].name)},addFav=e=>{!1===isFavSerie(e)&&(favSeries.push(series[e]),console.log("Add serie Index to `favSeries` array >>> Favourites:",favSeries))},removeFav=e=>{const t=favSeries.indexOf(series[e]);favSeries.splice(t,1),console.log("Remove from array `favSeries`>>> Favourites:",favSeries)},paintFavSeries=()=>{const e=document.querySelector(".js-listFav");let t="";for(let e=0;e<favSeries.length;e+=1)t+='<li class="fav__item js-fav">',t+=`<img class="fav__image" src="${favSeries[e].image}">`,t+=`<p class="fav__name">${favSeries[e].name}</p></li>`;e.innerHTML=t};buttonSearch.addEventListener("click",getDataFromServer),null===getSeriesFromLS()?buttonSearch.addEventListener("click",getDataFromServer):(paintFavSeries(),buttonSearch.addEventListener("click",getDataFromServer));